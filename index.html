<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>College Tour Payment</title>

    <script src="https://cdn.tailwindcss.com"></script>

    <script src="https://unpkg.com/lucide@latest"></script>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', sans-serif; }

        /* Animations */
        @keyframes slideIn { from { opacity:0; transform:translateX(20px);} to {opacity:1; transform:translateX(0);} }
        @keyframes scaleUp { from { opacity:0; transform:scale(0.9);} to {opacity:1; transform:scale(1);} }
        @keyframes bounceShort { 0%,100%{transform:translateY(0);} 50%{transform:translateY(-10px);} }
        @keyframes confettiFall { 0%{transform:translateY(0) rotate(0);} 100%{transform:translateY(100vh) rotate(720deg);} }

        .animate-slide-in { animation: slideIn .4s ease forwards; }
        .animate-scale-up { animation: scaleUp .5s ease-out forwards; }
        .animate-bounce-short { animation: bounceShort 1s infinite; }
        .animate-confetti {
            position:absolute;
            animation:confettiFall linear forwards;
        }

        .glass-card {
            background: rgba(255,255,255,0.10);
            border: 1px solid rgba(255,255,255,0.18);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
        }

        /* Input Autofill Fix */
        input:-webkit-autofill,
        input:-webkit-autofill:hover, 
        input:-webkit-autofill:focus {
            -webkit-text-fill-color: white;
            -webkit-box-shadow: 0 0 0px 1000px #000 inset;
            transition: background-color 5000s ease-in-out 0s;
        }

        /* --- INSTAGRAM STRIP CSS --- */
        .insta-strip {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            backdrop-filter: blur(12px) saturate(180%);
            -webkit-backdrop-filter: blur(12px) saturate(180%);
            background: rgba(0, 51, 102, 0.4); /* Darker transparent blue */
            border-top: 1px solid rgba(255,255,255,0.15);
            padding: 10px 0;
            overflow: hidden;
            z-index: 999;
        }

        .insta-track {
            display: flex;
            align-items: center;
            gap: 24px;
            /* Adjust duration (20s) to make it faster/slower */
            animation: scroll-left 15s linear infinite; 
            white-space: nowrap;
            width: max-content;
            padding-left: 100%; /* Start from right */
        }

        .insta-track img {
            width: 42px; 
            height: 42px; 
            border-radius: 50%; 
            border: 2px solid rgba(255,255,255,0.8);
            object-fit: cover;
            transition: transform 0.2s;
        }
        
        .insta-track a:hover img {
            transform: scale(1.1);
            border-color: #00c3ff;
        }

        .insta-text {
            font-size: 0.85rem;
            color: #ffffff; /* White text */
            font-weight: 600;
            letter-spacing: 0.5px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }

        @keyframes scroll-left {
            0% { transform: translateX(0); }
            100% { transform: translateX(-100%); }
        }
    </style>
</head>

<body class="min-h-screen w-full bg-[#003366] text-white flex justify-center items-start pt-10 pb-28 relative overflow-x-hidden">

    <div class="fixed top-[-10%] left-[-10%] w-[60%] h-[60%] bg-[#0077cc] rounded-full blur-[120px] opacity-30 pointer-events-none"></div>
    <div class="fixed bottom-[-10%] right-[-10%] w-[60%] h-[60%] bg-[#00c3ff] rounded-full blur-[100px] opacity-20 pointer-events-none"></div>

    <div class="w-full max-w-sm px-4 relative z-10">

        <div id="step-1" class="glass-card rounded-3xl p-6 shadow-2xl flex flex-col gap-5 animate-slide-in">

            <div class="text-center space-y-1">
                <h1 class="text-2xl font-bold">College One-Day Tour</h1>
                <p class="text-sm text-blue-100/80">Fill details to proceed with ₹850 payment</p>
            </div>

            <div class="space-y-4">
                <div>
                    <label class="text-xs text-blue-200 ml-1">Full Name</label>
                    <div class="relative">
                        <i data-lucide="user" class="absolute left-3 top-3.5 w-4 h-4 text-blue-300/70"></i>
                        <input id="name" type="text"
                            class="w-full bg-black/20 border border-white/10 rounded-xl py-3 pl-10 pr-4 text-sm text-white placeholder-white/30 focus:border-[#00c3ff] outline-none transition-colors" 
                            placeholder="John Doe">
                    </div>
                </div>

                <div>
                    <label class="text-xs text-blue-200 ml-1">Phone Number</label>
                    <div class="relative">
                        <i data-lucide="phone" class="absolute left-3 top-3.5 w-4 h-4 text-blue-300/70"></i>
                        <input id="phone" maxlength="10" type="tel"
                            oninput="this.value=this.value.replace(/[^0-9]/g,'')"
                            class="w-full bg-black/20 border border-white/10 rounded-xl py-3 pl-10 pr-4 text-sm text-white placeholder-white/30 focus:border-[#00c3ff] outline-none transition-colors" 
                            placeholder="9988776655">
                    </div>
                </div>

                <div>
                    <label class="text-xs text-blue-200 ml-1">USN / Roll No</label>
                    <div class="relative">
                        <i data-lucide="hash" class="absolute left-3 top-3.5 w-4 h-4 text-blue-300/70"></i>
                        <input id="usn"
                            class="w-full uppercase bg-black/20 border border-white/10 rounded-xl py-3 pl-10 pr-4 text-sm text-white placeholder-white/30 focus:border-[#00c3ff] outline-none transition-colors"
                            placeholder="2K24CS000">
                    </div>
                </div>
            </div>

            <div class="bg-gradient-to-r from-blue-900/40 to-black/20 border border-white/5 rounded-2xl p-4 flex justify-between items-center">
                <span class="text-sm text-blue-200">Total Amount</span>
                <span class="text-xl font-bold text-[#00c3ff]">₹850</span>
            </div>

            <button id="proceedBtn" onclick="goToStep2()"
                class="w-full bg-gradient-to-r from-[#0077cc] to-[#00c3ff] hover:from-[#0066aa] hover:to-[#00aadd] active:scale-[0.98] transition-all rounded-xl py-3.5 shadow-lg font-semibold flex justify-center gap-2">
                <span>Proceed to Pay</span>
                <i data-lucide="chevron-right" class="w-4 h-4 mt-1"></i>
            </button>

            <div class="pt-2 text-center border-t border-white/10 mt-1">
                <a href="tel:917795410516" class="inline-flex items-center gap-2 bg-white/5 px-4 py-2 rounded-full border border-white/5 hover:bg-white/10 transition cursor-pointer group">
                    <span class="text-[10px] text-blue-200 uppercase tracking-wide">Contact for Query:</span>
                    <span class="text-xs font-bold text-white group-hover:text-[#00c3ff] transition flex items-center gap-1">
                        +91 77954 10516
                    </span>
                </a>
            </div>
        </div>

        <div id="step-2" class="hidden glass-card rounded-3xl p-6 shadow-2xl flex flex-col gap-4 animate-slide-in">

            <div class="text-center relative">
                <button onclick="backToStep1()" class="absolute left-0 top-1 p-1 hover:bg-white/10 rounded-lg transition">
                    <i data-lucide="arrow-left" class="w-5 h-5 text-blue-200"></i>
                </button>
                <h2 class="text-xl font-bold">Scan & Pay</h2>
                <p class="text-xs text-blue-100/70">Pay using any UPI App</p>
            </div>

            <div class="bg-white rounded-2xl p-4 text-center shadow-inner">
                <img id="qr-image" class="w-40 h-40 mx-auto object-contain" alt="QR Code">
                <div class="mt-2 flex justify-center items-center gap-2 bg-gray-100 rounded-lg py-1 px-3">
                    <span class="text-[#003366] text-xs font-bold">7795410516-2@ybl</span>
                    <i data-lucide="copy" class="w-3 h-3 text-gray-500 cursor-pointer" onclick="navigator.clipboard.writeText('7795410516-2@ybl'); alert('UPI ID Copied!')"></i>
                </div>
            </div>

            <div class="space-y-1">
                <label class="text-xs text-blue-200 ml-1">Upload Payment Screenshot</label>
                <div class="flex gap-3">
                    <label class="flex-1 h-14 border border-dashed border-blue-300/30 rounded-xl flex flex-col items-center justify-center cursor-pointer hover:bg-white/5 transition bg-black/20">
                        <input type="file" id="file" class="hidden" accept="image/*" onchange="previewFile()">
                        <div class="flex items-center gap-2 text-blue-200">
                            <i data-lucide="upload" class="w-4 h-4"></i>
                            <span class="text-xs">Tap to upload</span>
                        </div>
                    </label>

                    <div id="previewBox" class="w-14 h-14 rounded-xl bg-black/40 border border-white/10 flex items-center justify-center overflow-hidden">
                        <i data-lucide="image" class="w-5 h-5 text-white/20" id="placeholderIcon"></i>
                        <img id="previewImg" class="hidden w-full h-full object-cover">
                    </div>
                </div>
            </div>

            <div>
                <label class="text-xs text-blue-200 ml-1">UTR / Transaction ID</label>
                <input id="utr" class="w-full bg-black/20 border border-white/10 rounded-xl py-3 px-4 text-sm placeholder-white/30 focus:border-[#00c3ff] outline-none transition-colors"
                    placeholder="Enter 12-digit UTR No.">
            </div>

            <div class="bg-yellow-500/10 border-l-4 border-yellow-500 rounded-r-lg p-3 flex gap-3 items-start">
                <i data-lucide="alert-triangle" class="w-5 h-5 text-yellow-500 shrink-0 mt-0.5"></i>
                <p class="text-[11px] text-yellow-100/90 leading-tight">
                    <strong>Important:</strong> Upload a clear screenshot & correct UTR. Invalid details will result in <strong>seat cancellation</strong>.
                    <br>You will receive a WhatsApp confirmation after manual verification.
                </p>
            </div>

            <button onclick="submitPayment()" id="submitBtn"
                class="w-full bg-gradient-to-r from-[#0077cc] to-[#00c3ff] hover:from-[#0066aa] hover:to-[#00aadd] active:scale-[0.98] transition-all rounded-xl py-3.5 shadow-lg font-semibold flex justify-center items-center gap-2">
                <span>Submit Payment</span>
                <i data-lucide="check-circle" class="w-4 h-4"></i>
            </button>
            
            <div class="text-center pt-1">
                <a href="tel:917795410516" class="text-[10px] text-blue-300/70 hover:text-white transition">
                    Contact for Query: +91 77954 10516
                </a>
            </div>

        </div>

        <div id="step-3" class="hidden glass-card rounded-3xl p-8 shadow-2xl flex flex-col items-center text-center gap-6 animate-scale-up relative">
            <div class="w-20 h-20 rounded-full bg-gradient-to-br from-green-400 to-green-600 flex items-center justify-center animate-bounce-short shadow-lg shadow-green-500/30">
                <i data-lucide="check" class="w-10 h-10 text-white"></i>
            </div>
            <div class="space-y-2">
                <h2 class="text-2xl font-bold text-white">Payment Submitted!</h2>
                <p class="text-sm text-blue-100/80">Your details have been recorded.<br>Verification will be completed shortly.<br>You'll get a WhatsApp confirmation.</p>
            </div>
            <button onclick="location.reload()" class="bg-white/10 hover:bg-white/20 border border-white/10 text-white w-full py-3 rounded-xl transition-all font-medium">
                Make Another Payment
            </button>
            <div id="confetti" class="absolute top-0 left-0 w-full h-full pointer-events-none overflow-hidden rounded-3xl"></div>
        </div>

    </div>

    <div class="insta-strip">
        <div class="insta-track">
            <span class="insta-text flex items-center gap-1">
                <i data-lucide="instagram" class="w-4 h-4"></i> Follow for updates
            </span>
            <a href="https://www.instagram.com/_pradeep_shingri_?igsh=MWRsOThyenAyMDJjOQ==" target="_blank">
                <img src="https://i.ibb.co/n8ts9bCW/Whats-App-Image-2025-11-28-at-11-32-36-PM-removebg-preview-Picsart-Ai-Image-Enhancer.png" alt="Insta1">
            </a>
            <a href="https://www.instagram.com/mr_mj_005?igsh=MTZ0ZzhnenE3emg4NQ==" target="_blank">
                <img src="https://i.ibb.co/mrqn1KXx/Whats-App-Image-2025-11-28-at-11-33-27-PM-removebg-preview-1.png" alt="Insta2">
            </a>
            <a href="https://www.instagram.com/_the_mini_squad_?igsh=ZG44eW5uam8wbjNv" target="_blank">
                <img src="https://i.ibb.co/ym1WhsPC/Whats-App-Image-2025-11-28-at-11-31-45-PM-removebg-preview-1.png" alt="Insta3">
            </a>
          

            <span class="insta-text flex items-center gap-1">
                <i data-lucide="instagram" class="w-4 h-4"></i> Follow for updates
            </span>
            <a href="https://www.instagram.com/_pradeep_shingri_?igsh=MWRsOThyenAyMDJjOQ==" target="_blank">
                <img src="https://i.ibb.co/n8ts9bCW/Whats-App-Image-2025-11-28-at-11-32-36-PM-removebg-preview-Picsart-Ai-Image-Enhancer.png" alt="Insta1">
            </a>
            <a href="https://www.instagram.com/mr_mj_005?igsh=MTZ0ZzhnenE3emg4NQ==" target="_blank">
                <img src="https://i.ibb.co/mrqn1KXx/Whats-App-Image-2025-11-28-at-11-33-27-PM-removebg-preview-1.png" alt="Insta2">
            </a>
            <a href="https://www.instagram.com/_the_mini_squad_?igsh=ZG44eW5uam8wbjNv" target="_blank">
                <img src="https://i.ibb.co/ym1WhsPC/Whats-App-Image-2025-11-28-at-11-31-45-PM-removebg-preview-1.png" alt="Insta3">
            </a>
           
        </div>
    </div>


    <script>
        lucide.createIcons();

        // ----------------------------------------------------
        const IMGBB_API_KEY = "e58aa227aaa82d432dae2f6cab637474"; 
        const SHEETDB_URL = "https://sheetdb.io/api/v1/x3iuyb45ttfkr";
        // ----------------------------------------------------

        function goToStep2() {
            const name = document.getElementById("name").value.trim();
            const phone = document.getElementById("phone").value.trim();
            const usn = document.getElementById("usn").value.trim();

            if (!name || phone.length !== 10 || !usn) {
                alert("Please enter Name, valid 10-digit Phone, and USN.");
                return;
            }

            const qrURL = "https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=" +
                encodeURIComponent(`upi://pay?pa=7795410516-2@ybl&pn=${name}&am=850&cu=INR`);

            document.getElementById("qr-image").src = qrURL;
            document.getElementById("step-1").classList.add("hidden");
            document.getElementById("step-2").classList.remove("hidden");
            window.scrollTo(0,0);
        }

        function backToStep1() {
            document.getElementById("step-2").classList.add("hidden");
            document.getElementById("step-1").classList.remove("hidden");
        }

        function previewFile() {
            const file = document.getElementById("file").files[0];
            if (!file) return;

            const img = document.getElementById("previewImg");
            const icon = document.getElementById("placeholderIcon");
            
            img.src = URL.createObjectURL(file);
            img.classList.remove("hidden");
            icon.classList.add("hidden");
        }

        // --- IMAGE COMPRESSION FUNCTION ---
        function compressImage(file) {
            return new Promise((resolve) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = (event) => {
                    const img = new Image();
                    img.src = event.target.result;
                    img.onload = () => {
                        const canvas = document.createElement('canvas');
                        // Maximum width 800px (keeps file small)
                        const scaleSize = 800 / img.width;
                        canvas.width = 800;
                        canvas.height = img.height * scaleSize;

                        const ctx = canvas.getContext('2d');
                        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);

                        // Compress to JPEG at 70% quality
                        canvas.toBlob((blob) => {
                            resolve(blob);
                        }, 'image/jpeg', 0.7);
                    };
                };
            });
        }

        async function submitPayment() {
            const btn = document.getElementById("submitBtn");
            const originalBtnText = btn.innerHTML;
            
            let name = document.getElementById("name").value.trim();
            let phone = document.getElementById("phone").value.trim();
            let usn = document.getElementById("usn").value.trim();
            let utr = document.getElementById("utr").value.trim();
            let file = document.getElementById("file").files[0];

            if (!utr || !file) {
                alert("Please upload the payment screenshot and enter the UTR number.");
                return;
            }

            // Show Loading State with status text
            btn.innerHTML = `<i data-lucide="loader-2" class="animate-spin w-5 h-5"></i> <span id="btnStatus">Compressing...</span>`;
            lucide.createIcons();
            btn.disabled = true;

            try {
                // 1. Compress Image
                const compressedFile = await compressImage(file);
                document.getElementById('btnStatus').innerText = "Uploading Proof...";

                // 2. Upload to ImgBB
                let fd = new FormData();
                fd.append("image", compressedFile);

                const uploadRes = await fetch(`https://api.imgbb.com/1/upload?key=${IMGBB_API_KEY}`, {
                    method: "POST",
                    body: fd
                });
                
                if(!uploadRes.ok) throw new Error("Image Upload Failed");
                const uploadJSON = await uploadRes.json();
                const screenshotURL = uploadJSON.data.url;

                // 3. Save to SheetDB
                document.getElementById('btnStatus').innerText = "Saving Data...";
                const data = {
                    data: {
                        timestamp: new Date().toLocaleString(),
                        name: name,
                        phone: phone,
                        usn: usn,
                        utr: utr,
                        screenshot: screenshotURL,
                        amount: 850,
                        status: "pending"
                    }
                };

                const sheetRes = await fetch(SHEETDB_URL, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(data)
                });

                if(!sheetRes.ok) throw new Error("Database Error");

                showSuccess();

            } catch (error) {
                alert("Error: " + error.message + ". Please try again.");
                btn.innerHTML = originalBtnText;
                btn.disabled = false;
            }
        }

        function showSuccess() {
            document.getElementById("step-2").classList.add("hidden");
            document.getElementById("step-3").classList.remove("hidden");
            launchConfetti();
        }

        function launchConfetti() {
            const box = document.getElementById("confetti");
            const colors = ["#00c3ff", "#0077cc", "#ffffff", "#FFD700"];
            for (let i = 0; i < 40; i++) {
                let c = document.createElement("div");
                c.classList.add("animate-confetti");
                c.style.left = Math.random() * 100 + "%";
                c.style.top = "-10px";
                c.style.background = colors[Math.floor(Math.random() * colors.length)];
                c.style.width = Math.random() * 6 + 4 + "px";
                c.style.height = Math.random() * 10 + 5 + "px";
                c.style.animationDuration = (Math.random() * 2 + 2) + "s";
                c.style.opacity = Math.random();
                box.appendChild(c);
            }
        }
    </script>

</body>

</html>
